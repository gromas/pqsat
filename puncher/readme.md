# Теоретическое обоснование метода «Recursive State-Space Matryoshka» (RSM) для решения задач 3-SAT

## 1. Введение
Традиционные методы решения задач выполнимости булевых формул (SAT) оперируют в пространстве бинарных переменных $V = \{x_1, x_2, \dots, x_n\}$, что ведет к экспоненциальной сложности поиска $2^n$. Метод «Матрёшка» (RSM) переводит задачу в дискретное пространство макро-состояний конфигураций ограничений, заменяя глобальный синтез Binary Decision Diagrams (BDD) на локально-детерминированную фильтрацию конфликтов.

## 2. Дискретизация пространства: Макро-узлы (Шары)
Пусть булева формула $F$ в форме 3-КНФ разбита на $K$ непересекающихся подмножеств клозов $T_k$, называемых «макро-узлами» или «тройками».

### 2.1. Конфигурационное пространство состояний
Для каждого макро-узла $T_k$ определяется конечное множество валидных локальных состояний $S_k$:
$$S_k = \{s_{k,1}, s_{k,2}, \dots, s_{k,m}\}$$
Каждое состояние $s_{k,i}$ представляет собой вектор значений переменных $var(T_k)$, при которых все клозы внутри $T_k$ истинны. В силу свойств 3-КНФ, для типичной тройки $|S_k| \le 2^p$, где $p$ — количество уникальных переменных в макро-узле.

### 2.2. Условие единственности выбора
Задача SAT в терминах RSM формулируется как выбор **ровно одного** состояния для каждого макро-узла:
$$\forall T_k: \left( \sum_{j=1}^{|S_k|} s_{k,j} = 1 \right)$$
Это переводит задачу из бинарного домена в домен многозначной логики над автономными «шарами» конфигураций.

## 3. Модель бинарных запретов (2-КНФ Редукция)
Связи между макро-узлами $T_A$ и $T_B$ возникают исключительно через общие переменные $V_{comm} = var(T_A) \cap var(T_B)$.

### 3.1. Формализация конфликта
Два состояния $s_{A,i}$ и $s_{B,j}$ конфликтуют, если они приписывают разные значения хотя бы одной переменной $x \in V_{comm}$. Набор всех таких конфликтов образует глобальную сеть запретов в форме 2-КНФ:
$$Conflict(s_{A,i}, s_{B,j}) \implies (\neg s_{A,i} \lor \neg s_{B,j})$$
Поскольку макро-узлы не пересекаются по переменным-состояниям (атомарность «шаров»), все взаимодействия в системе становятся **анти-монотонными**.

## 4. Алгоритм сжатия: Лавина Arc Consistency
Вместо построения глобальной функции переходов (BDD), RSM использует алгоритм фильтрации $AC-3$ для динамического сокращения областей определения $S_k$.

### 4.1. Правило элиминации состояния
Состояние $s_{A,i}$ удаляется из пространства поиска, если оно не имеет «поддержки» в смежном макро-узле $T_B$:
$$ \left( \forall s_{B,j} \in S_B: (s_{A,i} \text{ IS CONFLICT } s_{B,j}) \right) \implies S_A := S_A \setminus \{s_{A,i}\} $$
Удаление одного состояния инициирует цепную реакцию (лавину), распространяющую ограничение по графу конфликтов. Это позволяет доказывать $UNSAT$ или находить $SAT$ путем удаления невозможных «шаров Хемминга» без экспоненциального взрыва памяти.

## 5. Рекурсивное ветвление и BDD-верификация
Для преодоления структурной плотности в задачах типа $uf100$, применяется иерархическая фиксация (Рычаги).

1. **Выбор рычага:** Идентификация макро-узла с максимальной энтропией (количеством состояний).
2. **Ветвление:** Фиксация одного $s_{k,i}$ активирует лавину запретов, радикально упрощая остаточную задачу.
3. **Локальный синтез (BDD):** Когда суммарное количество выживших состояний во всех $S_k$ падает ниже критического порога $T \approx 400$, вызывается BDD-менеджер:
   $$BDD_{final} = \bigwedge_{k=1}^K \left( \bigvee s_{k,j} \right) \land \bigwedge Conflict(s_{i,a}, s_{j,b})$$

## 6. Заключение
Метод RSM эффективно эксплуатирует локальную разреженность 3-SAT. Переход к макро-состояниям позволяет декоррелировать переменные, превращая «плотный клубок» задачи в систему слабосвязанных конфигурационных «шаров». Это обеспечивает константное потребление оперативной памяти и высокую скорость доказательства невыполнимости через каскадную фильтрацию запретов.
